<!DOCTYPE html>
<html lang="kaa">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TÃ¼rkÃ§e â†” Qaraqalpaqsha SÃ¶zlik</title>
<link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@400;700;900&family=Noto+Sans:wght@300;400;500&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0a0e1a;
    --surface: #111827;
    --card: #1a2235;
    --border: #2a3a55;
    --accent1: #00d4aa;
    --accent2: #ff6b35;
    --accent3: #7c6af7;
    --text: #e8eaf6;
    --muted: #8899bb;
    --success: #22c55e;
    --danger: #ef4444;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: 'Noto Sans', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    background-image: radial-gradient(ellipse at 20% 20%, rgba(124,106,247,0.12) 0%, transparent 60%),
                      radial-gradient(ellipse at 80% 80%, rgba(0,212,170,0.08) 0%, transparent 60%);
  }

  header {
    text-align: center;
    padding: 2.5rem 1rem 1.5rem;
    border-bottom: 1px solid var(--border);
    background: linear-gradient(180deg, rgba(124,106,247,0.07) 0%, transparent 100%);
  }

  header h1 {
    font-family: 'Unbounded', sans-serif;
    font-size: clamp(1.3rem, 4vw, 2.2rem);
    font-weight: 900;
    letter-spacing: -1px;
    background: linear-gradient(90deg, var(--accent1), var(--accent3), var(--accent2));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  header p { color: var(--muted); margin-top: 0.5rem; font-size: 0.9rem; }

  /* TABS */
  .tabs {
    display: flex;
    gap: 0.5rem;
    justify-content: center;
    padding: 1.2rem 1rem 0;
    flex-wrap: wrap;
  }

  .tab-btn {
    font-family: 'Unbounded', sans-serif;
    font-size: 0.7rem;
    padding: 0.55rem 1.2rem;
    border: 1.5px solid var(--border);
    border-radius: 100px;
    background: transparent;
    color: var(--muted);
    cursor: pointer;
    transition: all 0.2s;
    letter-spacing: 0.5px;
  }

  .tab-btn.active {
    background: var(--accent3);
    border-color: var(--accent3);
    color: #fff;
  }

  /* MAIN LAYOUT */
  main { max-width: 1100px; margin: 0 auto; padding: 1.5rem 1rem 4rem; }

  /* ADD WORD PANEL */
  .add-panel {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 1.5rem;
    margin-bottom: 2rem;
    display: none;
  }

  .add-panel.show { display: block; }

  .add-panel h2 {
    font-family: 'Unbounded', sans-serif;
    font-size: 0.85rem;
    color: var(--accent1);
    margin-bottom: 1rem;
    letter-spacing: 1px;
    text-transform: uppercase;
  }

  .input-row {
    display: grid;
    grid-template-columns: 1fr 1fr auto;
    gap: 0.8rem;
    align-items: end;
    flex-wrap: wrap;
  }

  @media(max-width: 600px) {
    .input-row { grid-template-columns: 1fr; }
  }

  .input-group label {
    display: block;
    font-size: 0.75rem;
    color: var(--muted);
    margin-bottom: 0.4rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .input-group input, .input-group select {
    width: 100%;
    background: var(--surface);
    border: 1.5px solid var(--border);
    border-radius: 10px;
    padding: 0.75rem 1rem;
    color: var(--text);
    font-size: 1rem;
    font-family: 'Noto Sans', sans-serif;
    outline: none;
    transition: border-color 0.2s;
  }

  .input-group input:focus, .input-group select:focus {
    border-color: var(--accent3);
  }

  .input-group select option { background: var(--surface); }

  .img-row {
    margin-top: 0.8rem;
    display: grid;
    grid-template-columns: 1fr auto;
    gap: 0.8rem;
    align-items: center;
  }

  .img-row input { font-size: 0.85rem; }

  .btn {
    font-family: 'Unbounded', sans-serif;
    font-size: 0.75rem;
    font-weight: 700;
    padding: 0.75rem 1.4rem;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    letter-spacing: 0.5px;
    transition: transform 0.15s, box-shadow 0.15s;
    white-space: nowrap;
  }

  .btn:active { transform: scale(0.97); }

  .btn-primary {
    background: linear-gradient(135deg, var(--accent3), var(--accent1));
    color: #fff;
    box-shadow: 0 4px 20px rgba(124,106,247,0.4);
  }

  .btn-secondary {
    background: var(--surface);
    color: var(--text);
    border: 1.5px solid var(--border);
  }

  .btn-danger {
    background: transparent;
    color: var(--danger);
    border: 1.5px solid var(--danger);
    padding: 0.4rem 0.8rem;
    font-size: 0.7rem;
  }

  .btn-toggle {
    position: fixed;
    bottom: 1.5rem;
    right: 1.5rem;
    width: 56px;
    height: 56px;
    border-radius: 50%;
    font-size: 1.4rem;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
    z-index: 100;
    box-shadow: 0 6px 30px rgba(124,106,247,0.5);
    background: linear-gradient(135deg, var(--accent3), var(--accent1));
    border: none;
    cursor: pointer;
    transition: transform 0.2s;
  }

  .btn-toggle:hover { transform: scale(1.1) rotate(45deg); }

  /* SEARCH */
  .search-bar {
    display: flex;
    gap: 0.7rem;
    margin-bottom: 1.5rem;
  }

  .search-bar input {
    flex: 1;
    background: var(--card);
    border: 1.5px solid var(--border);
    border-radius: 12px;
    padding: 0.8rem 1.2rem;
    color: var(--text);
    font-size: 1rem;
    font-family: 'Noto Sans', sans-serif;
    outline: none;
    transition: border-color 0.2s;
  }

  .search-bar input:focus { border-color: var(--accent1); }

  /* CARDS GRID */
  .cards-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 1rem;
  }

  /* FLASHCARD */
  .flashcard {
    perspective: 1000px;
    height: 180px;
    cursor: pointer;
  }

  .flashcard-inner {
    width: 100%;
    height: 100%;
    position: relative;
    transform-style: preserve-3d;
    transition: transform 0.55s cubic-bezier(.4,0,.2,1);
    border-radius: 16px;
  }

  .flashcard.flipped .flashcard-inner {
    transform: rotateY(180deg);
  }

  .card-face {
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: 16px;
    backface-visibility: hidden;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 1.2rem;
    border: 1.5px solid var(--border);
    text-align: center;
    overflow: hidden;
  }

  .card-front {
    background: var(--card);
  }

  .card-back {
    background: linear-gradient(135deg, rgba(124,106,247,0.15), rgba(0,212,170,0.1));
    border-color: var(--accent3);
    transform: rotateY(180deg);
  }

  .card-face img {
    width: 70px;
    height: 70px;
    object-fit: cover;
    border-radius: 10px;
    margin-bottom: 0.7rem;
    border: 2px solid var(--border);
  }

  .card-lang {
    font-size: 0.65rem;
    font-family: 'Unbounded', sans-serif;
    letter-spacing: 1px;
    text-transform: uppercase;
    margin-bottom: 0.5rem;
    padding: 0.2rem 0.7rem;
    border-radius: 100px;
  }

  .card-lang.tr { background: rgba(255,107,53,0.15); color: var(--accent2); }
  .card-lang.kaa { background: rgba(0,212,170,0.15); color: var(--accent1); }

  .card-word {
    font-size: 1.3rem;
    font-weight: 600;
    color: var(--text);
    line-height: 1.3;
  }

  .card-hint {
    font-size: 0.72rem;
    color: var(--muted);
    margin-top: 0.5rem;
  }

  .card-actions {
    position: absolute;
    top: 0.6rem;
    right: 0.6rem;
    display: flex;
    gap: 0.3rem;
    z-index: 10;
  }

  /* QUIZ MODE */
  .quiz-container {
    max-width: 600px;
    margin: 0 auto;
    display: none;
  }

  .quiz-container.show { display: block; }

  .quiz-card {
    background: var(--card);
    border: 1.5px solid var(--border);
    border-radius: 20px;
    padding: 3rem 2rem;
    text-align: center;
    margin-bottom: 1.5rem;
    min-height: 250px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: border-color 0.2s;
    position: relative;
    overflow: hidden;
  }

  .quiz-card::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, rgba(124,106,247,0.05) 0%, transparent 60%);
    pointer-events: none;
  }

  .quiz-card:hover { border-color: var(--accent3); }

  .quiz-card img {
    width: 120px;
    height: 120px;
    object-fit: cover;
    border-radius: 14px;
    margin-bottom: 1rem;
    border: 2px solid var(--border);
  }

  .quiz-word {
    font-size: 2.5rem;
    font-weight: 600;
    margin: 0.5rem 0;
  }

  .quiz-answer {
    font-size: 1.5rem;
    color: var(--accent1);
    margin-top: 0.8rem;
    opacity: 0;
    transition: opacity 0.3s;
  }

  .quiz-answer.show { opacity: 1; }

  .quiz-tap { font-size: 0.8rem; color: var(--muted); margin-top: 1rem; }

  .quiz-btns {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0.8rem;
    margin-top: 1rem;
  }

  .btn-correct {
    background: linear-gradient(135deg, #166534, #22c55e);
    color: #fff;
    font-family: 'Unbounded', sans-serif;
    font-size: 0.8rem;
    font-weight: 700;
    padding: 1rem;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    letter-spacing: 0.5px;
    transition: transform 0.15s;
  }

  .btn-wrong {
    background: linear-gradient(135deg, #7f1d1d, #ef4444);
    color: #fff;
    font-family: 'Unbounded', sans-serif;
    font-size: 0.8rem;
    font-weight: 700;
    padding: 1rem;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    letter-spacing: 0.5px;
    transition: transform 0.15s;
  }

  .btn-correct:active, .btn-wrong:active { transform: scale(0.97); }

  .quiz-btns .btn-correct, .quiz-btns .btn-wrong { display: none; }
  .quiz-btns.revealed .btn-correct, .quiz-btns.revealed .btn-wrong { display: block; }

  .btn-next-quiz {
    display: none;
    width: 100%;
    margin-top: 0.8rem;
  }

  .quiz-score {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 0.8rem 1.2rem;
    display: flex;
    justify-content: center;
    gap: 2rem;
    margin-bottom: 1rem;
    font-size: 0.85rem;
  }

  .score-item { text-align: center; }
  .score-num {
    font-family: 'Unbounded', sans-serif;
    font-size: 1.4rem;
    font-weight: 700;
  }

  .score-num.correct { color: var(--success); }
  .score-num.wrong { color: var(--danger); }
  .score-label { color: var(--muted); font-size: 0.7rem; letter-spacing: 0.5px; text-transform: uppercase; }

  .quiz-progress {
    background: var(--surface);
    border-radius: 100px;
    height: 4px;
    margin-bottom: 1rem;
    overflow: hidden;
  }

  .quiz-progress-bar {
    height: 100%;
    background: linear-gradient(90deg, var(--accent3), var(--accent1));
    border-radius: 100px;
    transition: width 0.4s;
  }

  /* EMPTY STATE */
  .empty {
    text-align: center;
    padding: 4rem 1rem;
    color: var(--muted);
  }

  .empty .icon { font-size: 3rem; margin-bottom: 1rem; }

  /* STATS BAR */
  .stats-bar {
    display: flex;
    gap: 1rem;
    margin-bottom: 1.5rem;
    flex-wrap: wrap;
  }

  .stat-pill {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 100px;
    padding: 0.4rem 1rem;
    font-size: 0.78rem;
    color: var(--muted);
    display: flex;
    align-items: center;
    gap: 0.4rem;
  }

  .stat-pill span { color: var(--text); font-weight: 600; }

  /* FLIP HINT */
  .flip-hint {
    text-align: center;
    color: var(--muted);
    font-size: 0.75rem;
    margin-bottom: 1rem;
    letter-spacing: 0.5px;
  }

  /* TOAST */
  .toast {
    position: fixed;
    bottom: 5rem;
    left: 50%;
    transform: translateX(-50%) translateY(20px);
    background: var(--accent1);
    color: #0a0e1a;
    font-weight: 700;
    font-family: 'Unbounded', sans-serif;
    font-size: 0.75rem;
    padding: 0.7rem 1.5rem;
    border-radius: 100px;
    opacity: 0;
    pointer-events: none;
    transition: all 0.3s;
    z-index: 999;
  }

  .toast.show {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
  }

  /* MODE SELECTOR */
  .mode-bar {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1.5rem;
    flex-wrap: wrap;
    align-items: center;
  }

  .mode-label {
    font-size: 0.7rem;
    color: var(--muted);
    font-family: 'Unbounded', sans-serif;
    letter-spacing: 1px;
    text-transform: uppercase;
    margin-right: 0.3rem;
  }

  .mode-btn {
    font-family: 'Unbounded', sans-serif;
    font-size: 0.65rem;
    padding: 0.4rem 0.9rem;
    border: 1.5px solid var(--border);
    border-radius: 100px;
    background: transparent;
    color: var(--muted);
    cursor: pointer;
    transition: all 0.2s;
    letter-spacing: 0.5px;
  }

  .mode-btn.active {
    background: var(--surface);
    border-color: var(--accent1);
    color: var(--accent1);
  }

  .filter-dir {
    margin-left: auto;
    font-size: 0.7rem;
    padding: 0.4rem 0.9rem;
    border: 1.5px solid var(--border);
    border-radius: 100px;
    background: transparent;
    color: var(--muted);
    cursor: pointer;
    font-family: 'Unbounded', sans-serif;
    letter-spacing: 0.3px;
    transition: all 0.2s;
  }

  .filter-dir.active-tr { border-color: var(--accent2); color: var(--accent2); }
  .filter-dir.active-kaa { border-color: var(--accent1); color: var(--accent1); }
</style>
</head>
<body>

<header>
  <h1>TÃ¼rkÃ§e â†” Qaraqalpaqsha</h1>
  <p>SÃ¶zlik â€¢ Flashcard â€¢ Quiz</p>
</header>

<div class="tabs">
  <button class="tab-btn active" onclick="setTab('cards')">ðŸ—‚ Kartochkalar</button>
  <button class="tab-btn" onclick="setTab('quiz')">ðŸŽ¯ Quiz</button>
</div>

<main>

  <!-- ADD PANEL -->
  <div class="add-panel" id="addPanel">
    <h2>âž• JaÃ±a SÃ¶z Qos</h2>
    <div class="input-row">
      <div class="input-group">
        <label>TÃ¼rkÃ§e SÃ¶z</label>
        <input type="text" id="inputTR" placeholder="Ã¶rn: elma" />
      </div>
      <div class="input-group">
        <label>Qaraqalpaqsha SÃ¶z</label>
        <input type="text" id="inputKAA" placeholder="Ð¼Ñ‹ÑÐ°Ð»Ñ‹: Ð°Ð»Ð¼Ð°" />
      </div>
      <button class="btn btn-primary" onclick="addWord()">QOS</button>
    </div>
    <div class="img-row">
      <div class="input-group" style="flex:1">
        <label>Suwret URL (ixtiyariy)</label>
        <input type="text" id="inputIMG" placeholder="https://... yoki bo'sh qoldiring" />
      </div>
    </div>
  </div>

  <!-- CARDS TAB -->
  <div id="cardsTab">
    <div class="mode-bar">
      <span class="mode-label">Ko'rsetish:</span>
      <button class="mode-btn active" id="modeAll" onclick="setMode('all')">Barchasi</button>
      <button class="mode-btn" id="modeTR" onclick="setMode('tr')">TÃ¼rkÃ§e â†’ Qaraqalpaqsha</button>
      <button class="mode-btn" id="modeKAA" onclick="setMode('kaa')">Qaraqalpaqsha â†’ TÃ¼rkÃ§e</button>
    </div>

    <div class="search-bar">
      <input type="text" id="searchInput" placeholder="ðŸ” SÃ¶z izle..." oninput="renderCards()" />
    </div>

    <div class="stats-bar" id="statsBar"></div>

    <p class="flip-hint">ðŸ’¡ Kartochkani bas â€” jawabÄ±n kÃ¶r</p>

    <div class="cards-grid" id="cardsGrid"></div>
    <div class="empty" id="emptyState" style="display:none">
      <div class="icon">ðŸ“š</div>
      <p>Hali sÃ¶z qosilmagan.<br>+ tugmasÄ±n basÄ±p sÃ¶z qos!</p>
    </div>
  </div>

  <!-- QUIZ TAB -->
  <div class="quiz-container" id="quizTab">
    <div class="quiz-score">
      <div class="score-item">
        <div class="score-num correct" id="scoreCorrect">0</div>
        <div class="score-label">TawdÄ±m âœ“</div>
      </div>
      <div class="score-item">
        <div class="score-num" id="scoreTotal" style="color:var(--muted)">0</div>
        <div class="score-label">JÃ¡mi</div>
      </div>
      <div class="score-item">
        <div class="score-num wrong" id="scoreWrong">0</div>
        <div class="score-label">TawalmadÄ±m âœ—</div>
      </div>
    </div>

    <div class="quiz-progress"><div class="quiz-progress-bar" id="quizBar" style="width:0%"></div></div>

    <div class="quiz-card" id="quizCard" onclick="revealQuiz()">
      <div id="quizContent">
        <div id="quizLangBadge" class="card-lang tr">TÃœRKÃ‡E</div>
        <img id="quizImg" src="" style="display:none" alt="">
        <div class="quiz-word" id="quizWord">â€”</div>
        <div class="quiz-answer" id="quizAnswer"></div>
        <div class="quiz-tap" id="quizTap">ðŸ‘† Kartochkani bas â€” jawabÄ±n kÃ¶r</div>
      </div>
    </div>

    <div class="quiz-btns" id="quizBtns">
      <button class="btn-correct" onclick="markQuiz(true)">âœ“ TawdÄ±m</button>
      <button class="btn-wrong" onclick="markQuiz(false)">âœ— TawalmadÄ±m</button>
    </div>

    <button class="btn btn-secondary btn-next-quiz" id="btnNextQuiz" onclick="nextQuiz()" style="display:none">
      â–¶ Keyingi SÃ¶z
    </button>

    <div style="text-align:center;margin-top:1rem">
      <button class="btn btn-secondary" onclick="startQuiz()">ðŸ”„ Qayta Baslat</button>
    </div>
  </div>

</main>

<button class="btn-toggle" onclick="toggleAdd()" title="SÃ¶z qos">ï¼‹</button>
<div class="toast" id="toast"></div>

<script>
let words = JSON.parse(localStorage.getItem('sozlik_words') || '[]');
if (words.length === 0) {
  words = [
    { tr: "elma", kaa: "Ð°Ð»Ð¼Ð°", img: "" },
    { tr: "su", kaa: "ÑÑƒ", img: "" },
    { tr: "ev", kaa: "Ò¯Ð¹", img: "" },
    { tr: "kitap", kaa: "ÐºÐ¸Ñ‚Ð°Ð¿", img: "" },
    { tr: "gÃ¼neÅŸ", kaa: "Ò›ÑƒÑÑˆ", img: "" },
  ];
  save();
}

let displayMode = 'all'; // 'all' | 'tr' | 'kaa'
let currentTab = 'cards';

// Quiz state
let quizQueue = [];
let quizIdx = 0;
let quizCorrect = 0;
let quizWrong = 0;
let quizRevealed = false;
let quizDir = 'tr'; // which side shown

function save() {
  localStorage.setItem('sozlik_words', JSON.stringify(words));
}

function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2000);
}

function toggleAdd() {
  const p = document.getElementById('addPanel');
  p.classList.toggle('show');
  if (p.classList.contains('show')) document.getElementById('inputTR').focus();
}

function addWord() {
  const tr = document.getElementById('inputTR').value.trim();
  const kaa = document.getElementById('inputKAA').value.trim();
  const img = document.getElementById('inputIMG').value.trim();
  if (!tr || !kaa) { showToast('âš  Eki tilni toltirinÃ±!'); return; }
  words.unshift({ tr, kaa, img });
  save();
  document.getElementById('inputTR').value = '';
  document.getElementById('inputKAA').value = '';
  document.getElementById('inputIMG').value = '';
  renderCards();
  showToast('âœ“ SÃ¶z qosÄ±ldÄ±!');
}

function deleteWord(idx) {
  words.splice(idx, 1);
  save();
  renderCards();
}

function setMode(m) {
  displayMode = m;
  document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('mode' + m.charAt(0).toUpperCase() + m.slice(1)).classList.add('active');
  renderCards();
}

function setTab(tab) {
  currentTab = tab;
  document.querySelectorAll('.tab-btn').forEach((b, i) => {
    b.classList.toggle('active', (i === 0 && tab === 'cards') || (i === 1 && tab === 'quiz'));
  });
  document.getElementById('cardsTab').style.display = tab === 'cards' ? 'block' : 'none';
  document.getElementById('quizTab').classList.toggle('show', tab === 'quiz');
  if (tab === 'quiz') startQuiz();
}

function getFilteredWords() {
  const q = document.getElementById('searchInput')?.value?.toLowerCase() || '';
  return words.filter(w =>
    w.tr.toLowerCase().includes(q) || w.kaa.toLowerCase().includes(q)
  );
}

function renderCards() {
  const grid = document.getElementById('cardsGrid');
  const empty = document.getElementById('emptyState');
  const stats = document.getElementById('statsBar');
  const filtered = getFilteredWords();

  stats.innerHTML = `
    <div class="stat-pill">JÃ¡mi: <span>${words.length}</span></div>
    <div class="stat-pill">TÃ¼rkÃ§e sÃ¶z: <span>${words.length}</span></div>
  `;

  if (filtered.length === 0) {
    grid.innerHTML = '';
    empty.style.display = 'block';
    return;
  }
  empty.style.display = 'none';

  grid.innerHTML = filtered.map((w, i) => {
    const realIdx = words.indexOf(w);
    // Determine which side is shown vs hidden
    let frontLang, frontWord, backLang, backWord;
    if (displayMode === 'kaa') {
      frontLang = 'kaa'; frontWord = w.kaa;
      backLang = 'tr'; backWord = w.tr;
    } else {
      // 'all' = random mix or TR first; 'tr' = TR first
      frontLang = 'tr'; frontWord = w.tr;
      backLang = 'kaa'; backWord = w.kaa;
    }
    // In 'all' mode, every other card shows kaa first
    if (displayMode === 'all' && i % 2 === 1) {
      [frontLang, frontWord, backLang, backWord] = [backLang, backWord, frontLang, frontWord];
    }

    const imgHtml = w.img
      ? `<img src="${w.img}" alt="${frontWord}" onerror="this.style.display='none'">`
      : '';

    return `
      <div class="flashcard" id="fc_${realIdx}" onclick="flipCard(${realIdx})">
        <div class="flashcard-inner">
          <div class="card-face card-front">
            <div class="card-actions" onclick="event.stopPropagation()">
              <button class="btn btn-danger" onclick="deleteWord(${realIdx})">âœ•</button>
            </div>
            <div class="card-lang ${frontLang}">${frontLang === 'tr' ? 'TÃœRKÃ‡E' : 'QARAQALPAQ'}</div>
            ${imgHtml}
            <div class="card-word">${frontWord}</div>
            <div class="card-hint">basÄ±p kÃ¶riÃ± â†’</div>
          </div>
          <div class="card-face card-back">
            <div class="card-lang ${backLang}">${backLang === 'tr' ? 'TÃœRKÃ‡E' : 'QARAQALPAQ'}</div>
            ${imgHtml}
            <div class="card-word">${backWord}</div>
          </div>
        </div>
      </div>
    `;
  }).join('');
}

function flipCard(idx) {
  const el = document.getElementById('fc_' + idx);
  if (el) el.classList.toggle('flipped');
}

// QUIZ
function startQuiz() {
  if (words.length === 0) return;
  quizQueue = [...words].sort(() => Math.random() - 0.5);
  quizIdx = 0; quizCorrect = 0; quizWrong = 0;
  updateScoreDisplay();
  showQuizCard();
}

function showQuizCard() {
  if (quizIdx >= quizQueue.length) {
    document.getElementById('quizWord').textContent = 'ðŸŽ‰ Tamam!';
    document.getElementById('quizAnswer').textContent = `${quizCorrect}/${quizQueue.length} tawdÄ±Ã±Ä±z!`;
    document.getElementById('quizAnswer').classList.add('show');
    document.getElementById('quizTap').style.display = 'none';
    document.getElementById('quizBtns').classList.remove('revealed');
    document.getElementById('btnNextQuiz').style.display = 'none';
    document.getElementById('quizBar').style.width = '100%';
    return;
  }

  quizRevealed = false;
  const w = quizQueue[quizIdx];
  // Alternate direction
  quizDir = (quizIdx % 2 === 0) ? 'tr' : 'kaa';

  const badge = document.getElementById('quizLangBadge');
  const word = document.getElementById('quizWord');
  const answer = document.getElementById('quizAnswer');
  const img = document.getElementById('quizImg');
  const tap = document.getElementById('quizTap');

  if (quizDir === 'tr') {
    badge.className = 'card-lang tr';
    badge.textContent = 'TÃœRKÃ‡E';
    word.textContent = w.tr;
    answer.textContent = w.kaa;
  } else {
    badge.className = 'card-lang kaa';
    badge.textContent = 'QARAQALPAQ';
    word.textContent = w.kaa;
    answer.textContent = w.tr;
  }

  answer.classList.remove('show');
  tap.style.display = 'block';
  tap.textContent = 'ðŸ‘† BasÄ±p jawabÄ±n kÃ¶r';

  if (w.img) {
    img.src = w.img;
    img.style.display = 'block';
    img.onerror = () => { img.style.display = 'none'; };
  } else {
    img.style.display = 'none';
  }

  document.getElementById('quizBtns').classList.remove('revealed');
  document.getElementById('btnNextQuiz').style.display = 'none';

  const prog = ((quizIdx) / quizQueue.length) * 100;
  document.getElementById('quizBar').style.width = prog + '%';
}

function revealQuiz() {
  if (quizRevealed) return;
  quizRevealed = true;
  document.getElementById('quizAnswer').classList.add('show');
  document.getElementById('quizTap').style.display = 'none';
  document.getElementById('quizBtns').classList.add('revealed');
}

function markQuiz(correct) {
  if (correct) quizCorrect++; else quizWrong++;
  quizIdx++;
  updateScoreDisplay();
  showQuizCard();
}

function nextQuiz() {
  quizIdx++;
  updateScoreDisplay();
  showQuizCard();
}

function updateScoreDisplay() {
  document.getElementById('scoreCorrect').textContent = quizCorrect;
  document.getElementById('scoreWrong').textContent = quizWrong;
  document.getElementById('scoreTotal').textContent = quizIdx;
}

// INIT
renderCards();
document.getElementById('quizTab').style.display = '';
document.getElementById('quizTab').classList.remove('show');
</script>
</body>
</html>
